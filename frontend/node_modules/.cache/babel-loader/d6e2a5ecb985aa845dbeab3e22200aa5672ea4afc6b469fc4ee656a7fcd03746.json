{"ast":null,"code":"var _jsxFileName = \"/Users/jsy/Desktop/ai-travel-app/frontend/src/pages/MapView.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { MapContainer, TileLayer, Marker, useMapEvents, useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet-control-geocoder/dist/Control.Geocoder.css';\nimport 'leaflet-control-geocoder';\n\n// 修复默认图标不显示\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png'\n});\n\n// 📍添加 Geocoder 控件\nfunction GeocoderControl() {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    if (!map) return;\n    const geocoder = L.Control.geocoder({\n      defaultMarkGeocode: true,\n      placeholder: 'Search location...',\n      geocoder: L.Control.Geocoder.nominatim()\n    }).addTo(map);\n    return () => map.removeControl(geocoder);\n  }, [map]);\n  return null;\n}\n\n// 📍地图点击选点\n_s(GeocoderControl, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c = GeocoderControl;\nfunction LocationMarker({\n  onSelect\n}) {\n  _s2();\n  const [position, setPosition] = useState(null);\n  useMapEvents({\n    click: async e => {\n      const {\n        lat,\n        lng\n      } = e.latlng;\n      setPosition([lat, lng]);\n      try {\n        const response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json&accept-language=en`);\n        const data = await response.json();\n        const locationName = data.display_name || \"Unknown Location\";\n        onSelect(locationName);\n      } catch (error) {\n        console.error(\"Failed to get location:\", error);\n        onSelect(\"Unknown Location\");\n      }\n    }\n  });\n  return position ? /*#__PURE__*/_jsxDEV(Marker, {\n    position: position\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 21\n  }, this) : null;\n}\n_s2(LocationMarker, \"d+iGiIlX3PyrS97OlxTSSv84eug=\", false, function () {\n  return [useMapEvents];\n});\n_c2 = LocationMarker;\nexport default function MapView({\n  onLocationSelected\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      height: '400px',\n      width: '100%'\n    },\n    children: /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: [30.25, 120.15],\n      zoom: 10,\n      scrollWheelZoom: true,\n      style: {\n        height: '100%',\n        width: '100%'\n      },\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 OpenStreetMap\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(GeocoderControl, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(LocationMarker, {\n        onSelect: onLocationSelected\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n_c3 = MapView;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"GeocoderControl\");\n$RefreshReg$(_c2, \"LocationMarker\");\n$RefreshReg$(_c3, \"MapView\");","map":{"version":3,"names":["React","useState","useEffect","MapContainer","TileLayer","Marker","useMapEvents","useMap","L","jsxDEV","_jsxDEV","Icon","Default","prototype","_getIconUrl","mergeOptions","iconUrl","iconRetinaUrl","shadowUrl","GeocoderControl","_s","map","geocoder","Control","defaultMarkGeocode","placeholder","Geocoder","nominatim","addTo","removeControl","_c","LocationMarker","onSelect","_s2","position","setPosition","click","e","lat","lng","latlng","response","fetch","data","json","locationName","display_name","error","console","fileName","_jsxFileName","lineNumber","columnNumber","_c2","MapView","onLocationSelected","style","height","width","children","center","zoom","scrollWheelZoom","attribution","url","_c3","$RefreshReg$"],"sources":["/Users/jsy/Desktop/ai-travel-app/frontend/src/pages/MapView.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { MapContainer, TileLayer, Marker, useMapEvents, useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet-control-geocoder/dist/Control.Geocoder.css';\nimport 'leaflet-control-geocoder';\n\n// 修复默认图标不显示\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\n});\n\n// 📍添加 Geocoder 控件\nfunction GeocoderControl() {\n  const map = useMap();\n\n  useEffect(() => {\n    if (!map) return;\n\n    const geocoder = L.Control.geocoder({\n      defaultMarkGeocode: true,\n      placeholder: 'Search location...',\n      geocoder: L.Control.Geocoder.nominatim(),\n    }).addTo(map);\n\n    return () => map.removeControl(geocoder);\n  }, [map]);\n\n  return null;\n}\n\n// 📍地图点击选点\nfunction LocationMarker({ onSelect }) {\n  const [position, setPosition] = useState(null);\n\n  useMapEvents({\n    click: async (e) => {\n      const { lat, lng } = e.latlng;\n      setPosition([lat, lng]);\n\n      try {\n        const response = await fetch(\n          `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json&accept-language=en`\n        );\n        const data = await response.json();\n        const locationName = data.display_name || \"Unknown Location\";\n        onSelect(locationName);\n      } catch (error) {\n        console.error(\"Failed to get location:\", error);\n        onSelect(\"Unknown Location\");\n      }\n    },\n  });\n\n  return position ? <Marker position={position} /> : null;\n}\n\nexport default function MapView({ onLocationSelected }) {\n  return (\n    <div style={{ height: '400px', width: '100%' }}>\n      <MapContainer center={[30.25, 120.15]} zoom={10} scrollWheelZoom={true} style={{ height: '100%', width: '100%' }}>\n        <TileLayer\n          attribution='&copy; OpenStreetMap'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        <GeocoderControl />\n        <LocationMarker onSelect={onLocationSelected} />\n      </MapContainer>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}