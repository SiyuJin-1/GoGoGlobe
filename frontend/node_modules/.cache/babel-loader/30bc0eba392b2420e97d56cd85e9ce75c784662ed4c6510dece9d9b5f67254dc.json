{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Popup}from'react-leaflet';import{MapContainer,TileLayer,Marker,useMap,useMapEvents}from'react-leaflet';import L from'leaflet';import'leaflet/dist/leaflet.css';import'leaflet-control-geocoder/dist/Control.Geocoder.css';import'leaflet-control-geocoder';// ÈªòËÆ§ÊåÇËΩΩÂà∞ L.Control.Geocoder\nimport'./MapView.css';// ‰øÆÂ§çÂõæÊ†á‰∏çÊòæÁ§∫\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";delete L.Icon.Default.prototype._getIconUrl;L.Icon.Default.mergeOptions({iconUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',iconRetinaUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png'});// ÊêúÁ¥¢Êéß‰ª∂\nfunction GeocoderControl(_ref){let{setSearchMarker}=_ref;const map=useMap();useEffect(()=>{if(!map||!L.Control.Geocoder)return;const geocoder=L.Control.geocoder({position:'topleft',defaultMarkGeocode:true,placeholder:'Search location...',geocoder:L.Control.Geocoder.nominatim()}).addTo(map);geocoder.on('markgeocode',function(e){const{center,name}=e.geocode;map.setView(center,map.getZoom());// ‚úÖ ËÆæÁΩÆ marker Âíå nameÔºåÁî®‰∫é‰πãÂêéÁÇπÂáªÊâçÈÄâ‰∏≠\nsetSearchMarker({position:[center.lat,center.lng],name});});return()=>map.removeControl(geocoder);},[map,setSearchMarker]);return null;}// ÁÇπÂáªÂú∞ÂõæËé∑Âèñ‰ΩçÁΩÆ + ËøîÂõûÂú∞ÂùÄ\nfunction LocationMarker(_ref2){let{onSelect}=_ref2;const[position,setPosition]=useState(null);const[popupText,setPopupText]=useState(null);const map=useMap();useMapEvents({click:async e=>{const{lat,lng}=e.latlng;setPosition([lat,lng]);try{const res=await fetch(\"https://nominatim.openstreetmap.org/reverse?lat=\".concat(lat,\"&lon=\").concat(lng,\"&format=json&accept-language=en\"));const data=await res.json();const locationName=data.display_name||'Unknown';setPopupText(locationName);onSelect(locationName);}catch(err){console.error('Reverse geocoding error:',err);setPopupText(\"Unknown location\");}}});return position?/*#__PURE__*/_jsx(Marker,{position:position,children:popupText&&/*#__PURE__*/_jsx(Popup,{children:popupText})}):null;}export default function MapView(_ref3){let{onLocationSelected}=_ref3;const[searchMarker,setSearchMarker]=useState(null);// { position: [...], name: '...' }\nreturn/*#__PURE__*/_jsxs(MapContainer,{center:[37.7749,-122.4194],zoom:13,scrollWheelZoom:true,style:{height:'100%',width:'100%'},children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 OpenStreetMap contributors\",url:\"https://a.tile.openstreetmap.de/{z}/{x}/{y}.png\"}),/*#__PURE__*/_jsx(GeocoderControl,{setSearchMarker:setSearchMarker}),/*#__PURE__*/_jsx(LocationMarker,{onSelect:onLocationSelected}),searchMarker&&/*#__PURE__*/_jsx(Marker,{position:searchMarker.position,eventHandlers:{click:()=>onLocationSelected(searchMarker.name)// ‚úÖ Áî®Êà∑ÁÇπÂáªËìùÊ†áÊó∂ÊâçËß¶ÂèëÈÄâÊã©\n},children:/*#__PURE__*/_jsxs(Popup,{children:[\"\\uD83D\\uDCCD \",searchMarker.name]})})]});}","map":{"version":3,"names":["React","useState","useEffect","Popup","MapContainer","TileLayer","Marker","useMap","useMapEvents","L","jsx","_jsx","jsxs","_jsxs","Icon","Default","prototype","_getIconUrl","mergeOptions","iconUrl","iconRetinaUrl","shadowUrl","GeocoderControl","_ref","setSearchMarker","map","Control","Geocoder","geocoder","position","defaultMarkGeocode","placeholder","nominatim","addTo","on","e","center","name","geocode","setView","getZoom","lat","lng","removeControl","LocationMarker","_ref2","onSelect","setPosition","popupText","setPopupText","click","latlng","res","fetch","concat","data","json","locationName","display_name","err","console","error","children","MapView","_ref3","onLocationSelected","searchMarker","zoom","scrollWheelZoom","style","height","width","attribution","url","eventHandlers"],"sources":["/Users/jsy/Desktop/ai-travel-app/frontend/src/pages/MapView.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Popup} from 'react-leaflet';\n\nimport {\n  MapContainer,\n  TileLayer,\n  Marker,\n  useMap,\n  useMapEvents\n} from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport 'leaflet-control-geocoder/dist/Control.Geocoder.css';\nimport 'leaflet-control-geocoder'; // ÈªòËÆ§ÊåÇËΩΩÂà∞ L.Control.Geocoder\n\nimport './MapView.css';\n\n// ‰øÆÂ§çÂõæÊ†á‰∏çÊòæÁ§∫\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png'\n});\n\n// ÊêúÁ¥¢Êéß‰ª∂\nfunction GeocoderControl({ setSearchMarker }) {\n  const map = useMap();\n\n  useEffect(() => {\n    if (!map || !L.Control.Geocoder) return;\n\n    const geocoder = L.Control.geocoder({\n      position: 'topleft',\n      defaultMarkGeocode: true, \n      placeholder: 'Search location...',\n      geocoder: L.Control.Geocoder.nominatim()\n    }).addTo(map);\n\n    geocoder.on('markgeocode', function (e) {\n      const { center, name } = e.geocode;\n      map.setView(center, map.getZoom());\n\n      // ‚úÖ ËÆæÁΩÆ marker Âíå nameÔºåÁî®‰∫é‰πãÂêéÁÇπÂáªÊâçÈÄâ‰∏≠\n      setSearchMarker({ position: [center.lat, center.lng], name });\n    });\n\n    return () => map.removeControl(geocoder);\n  }, [map, setSearchMarker]);\n\n  return null;\n}\n\n\n\n// ÁÇπÂáªÂú∞ÂõæËé∑Âèñ‰ΩçÁΩÆ + ËøîÂõûÂú∞ÂùÄ\nfunction LocationMarker({ onSelect }) {\n  const [position, setPosition] = useState(null);\n  const [popupText, setPopupText] = useState(null);\n  const map = useMap();\n  useMapEvents({\n    click: async (e) => {\n      const { lat, lng } = e.latlng;\n      setPosition([lat, lng]);\n\n      try {\n        const res = await fetch(\n          `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json&accept-language=en`\n        );\n        const data = await res.json();\n        const locationName = data.display_name || 'Unknown';\n        setPopupText(locationName);\n        onSelect(locationName);\n      } catch (err) {\n        console.error('Reverse geocoding error:', err);\n        setPopupText(\"Unknown location\");\n      }\n    }\n  });\n\n    return position ? (\n    <Marker position={position}>\n      {popupText && <Popup>{popupText}</Popup>}\n    </Marker> ) : null;\n}\n\nexport default function MapView({ onLocationSelected }) {\n  const [searchMarker, setSearchMarker] = useState(null); // { position: [...], name: '...' }\n\n  return (\n    <MapContainer center={[37.7749, -122.4194]} zoom={13} scrollWheelZoom={true} style={{ height: '100%', width: '100%' }}>\n      <TileLayer\n        attribution=\"&copy; OpenStreetMap contributors\"\n        url=\"https://a.tile.openstreetmap.de/{z}/{x}/{y}.png\"\n      />\n      <GeocoderControl setSearchMarker={setSearchMarker} />\n      <LocationMarker onSelect={onLocationSelected} />\n      {searchMarker && (\n        <Marker\n          position={searchMarker.position}\n          eventHandlers={{\n            click: () => onLocationSelected(searchMarker.name) // ‚úÖ Áî®Êà∑ÁÇπÂáªËìùÊ†áÊó∂ÊâçËß¶ÂèëÈÄâÊã©\n          }}\n        >\n          <Popup>üìç {searchMarker.name}</Popup>\n        </Marker>\n      )}\n    </MapContainer>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}